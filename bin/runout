#!/usr/local/bin/bash -u

param_file=$1
output_file=$(bin/param2data $1)
exe=$2
rootdir=$(dirname $(dirname $param_file))
echo $rootdir

source $param_file

echo "$exe $size $N $eta $threshold $output_file"

logdir=$rootdir/"log"
if [ ! -e $logdir ]; then
    mkdir $logdir
fi
logfile=$logdir/$(basename $param_file).log
touch $logfile

echo "./$exe $size $N $eta $threshold $sigma $output_file >> $logdir/$(basename $param_file).log"

date > $logfile
./$exe $size $N $eta $threshold $sigma $output_file >> $logdir/$(basename $param_file).log
date >> $logfile
